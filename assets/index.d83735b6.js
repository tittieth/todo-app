(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&l(d)}).observe(document,{childList:!0,subtree:!0});function r(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerpolicy&&(c.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?c.credentials="include":o.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function l(o){if(o.ep)return;o.ep=!0;const c=r(o);fetch(o.href,c)}})();let n=JSON.parse(localStorage.getItem("todos"))||[];const k=document.querySelector("#new-todo-form"),S=document.querySelector("#name"),q=localStorage.getItem("username")||"",w=document.querySelector("#due-date-input"),M=document.querySelector("#content"),v=document.querySelector("#error-msg"),s=new Date,I=s.getUTCFullYear(),B=s.getMonth()+1,H=s.getDate(),E=document.querySelector("#sort"),N=document.querySelector("#completed"),O=document.querySelector("#active"),$=document.querySelector("#all"),F=document.querySelector("#clear-all"),D=document.querySelector("#todo-list"),x=`${I}-${B}-${H}`;S.value=q;S.addEventListener("change",t=>{localStorage.setItem("username",`${t.target.value}!`)});function P(){document.querySelector("#due-date-input").setAttribute("min",x)}function i(t){const e=document.querySelector("#items-left"),r=t.length===1?"todo":"todos";e.innerHTML=`${t.length} ${r}`}function V(){n.sort((t,e)=>t.done<e.done?-1:t.done>e.done?1:0)}function f(){localStorage.setItem("todos",JSON.stringify(n))}function a(t){D.innerHTML="",t.forEach(e=>{const r=document.createElement("div");r.classList.add("todo-item");const l=document.createElement("label"),o=document.createElement("input"),c=document.createElement("div"),d=document.createElement("div"),u=document.createElement("div"),y=document.createElement("div"),g=document.createElement("button"),p=document.createElement("button");l.setAttribute("aria-label","check when done"),o.type="checkbox",o.checked=e.done,e.category==="personal"&&u.classList.add("category-personal"),e.category==="kids"&&u.classList.add("category-kids"),e.category==="job"&&u.classList.add("category-job"),e.category==="other"&&u.classList.add("category-other"),c.classList.add("todo-content"),d.classList.add("duedate-div"),u.classList.add("category-icon"),y.classList.add("actions"),g.classList.add("edit"),p.classList.add("delete");const h=new Date(e.dueDate),T=new Date(s.getFullYear(),s.getMonth(),s.getDate()+5);h<s?r.classList.add("deadline-passed"):h<=T&&r.classList.add("deadline-soon"),d.innerHTML=e.dueDate,c.innerHTML=`<input type="text" value="${e.content}" maxlength="25" aria-label="Your todo" readonly>`,g.innerHTML="Edit",p.innerHTML="Delete",l.appendChild(o),r.appendChild(l),r.appendChild(c),r.appendChild(d),r.appendChild(u),r.appendChild(y),y.appendChild(g),y.appendChild(p),D.appendChild(r),e.done&&(r.classList.add("done"),r.classList.remove("deadline-soon"),r.classList.remove("deadline-passed")),o.addEventListener("click",m=>{e.done=m.target.checked,e.done?r.classList.add("done"):r.classList.remove("done"),V(),a(n),f()});const L=c.querySelector("input");function b(){L.removeAttribute("readonly"),L.focus()}function A(m){L.setAttribute("readonly",!0),e.content=m.target.value,f()}g.addEventListener("click",b),L.addEventListener("blur",A);function C(){n=n.filter(m=>m!==e),f(),a(n),i(n)}p.addEventListener("click",C)})}function Y(t){t.preventDefault();const e={content:t.target.elements.content.value,dueDate:t.target.elements.dueDate.value,category:t.target.elements.category.value,done:!1,createdAt:new Date().getTime()};if(document.querySelector('input[name="category"]:checked')===null||w.value===""||M.value===0){v.removeAttribute("hidden",""),v.innerHTML="Add todo, category and due date!";return}n.push(e),f(),t.target.reset(),v.setAttribute("hidden",""),a(n),i(n)}a(n);i(n);function j(){n.sort((t,e)=>t.dueDate<e.dueDate?-1:t.dueDate>e.dueDate?1:0)}function J(){n.sort((t,e)=>t.createdAt<e.createdAt?-1:t.createdAt>e.createdAt?1:0)}function K(){n.sort((t,e)=>t.content.toLowerCase()<e.content.toLowerCase()?-1:t.content.toLowerCase()>e.content.toLowerCase()?1:0)}function U(){n.sort((t,e)=>t.category<e.category?-1:t.category>e.category?1:0)}function z(){const t=E.value;t==="name"?K():t==="added-date"?J():t==="due-date"?j():t==="category"&&U(),a(n)}function G(){a(n),i(n)}function Q(){const t=n.filter(e=>e.done===!1);a(t),i(t)}function R(){const t=n.filter(e=>e.done===!0);a(t),i(t)}function W(){n=[],f(),a(n),i(n)}k.addEventListener("submit",Y);E.addEventListener("change",z);N.addEventListener("click",R);O.addEventListener("click",Q);$.addEventListener("click",G);F.addEventListener("click",W);P();
